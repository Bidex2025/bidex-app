# Bidex - حزمة التطبيق الكامل (Full Stack)

تحتوي هذه الحزمة على الكود المصدري لمنصة Bidex، بما في ذلك الواجهة الأمامية (Frontend - المبنية بـ Next.js) والواجهة الخلفية (Backend - المبنية بـ NestJS)، بالإضافة إلى إعدادات Docker لتسهيل عملية النشر.

## هيكل المجلدات المحدث

```
/bidex_updated_package
├── backend/
│   ├── Dockerfile         # إعدادات Docker للواجهة الخلفية
│   └── ...              # بقية ملفات الواجهة الخلفية
├── frontend/
│   ├── Dockerfile         # إعدادات Docker للواجهة الأمامية
│   └── ...              # بقية ملفات الواجهة الأمامية
├── docker-compose.yml   # ملف لتشغيل الواجهتين معاً باستخدام Docker
├── .env.example         # ملف مثال لمتغيرات البيئة لـ Docker
├── README.md            # ملف التعليمات باللغة الإنجليزية
└── README.ar.md         # ملف التعليمات هذا (باللغة العربية)
```

## الخيار الأول: النشر باستخدام Docker (موصى به)

هذا الخيار يبسط عملية النشر بشكل كبير عن طريق استخدام حاويات Docker.

### المتطلبات الأساسية لـ Docker

*   **Docker:** قم بتثبيت Docker Desktop (لنظامي التشغيل Windows و Mac) أو Docker Engine (لنظام Linux). يمكنك العثور على إرشادات التثبيت على [موقع Docker الرسمي](https://docs.docker.com/engine/install/).
*   **Docker Compose:** يأتي عادةً مدمجًا مع Docker Desktop. إذا كنت تستخدم Docker Engine على Linux، فقد تحتاج إلى تثبيته بشكل منفصل. اتبع [دليل التثبيت الرسمي لـ Docker Compose](https://docs.docker.com/compose/install/).

### إعداد متغيرات البيئة لـ Docker

1.  **إنشاء ملف `.env`:** في المجلد الجذر للحزمة (`bidex_updated_package`)، قم بإنشاء ملف جديد باسم `.env`. يمكنك نسخ محتويات ملف `.env.example` المرفق كنقطة بداية.

    ```dotenv
    # ملف .env (في المجلد الجذر)

    # منفذ الواجهة الخلفية على الجهاز المضيف (Host)
    BACKEND_PORT=3000

    # منفذ الواجهة الأمامية على الجهاز المضيف (Host)
    FRONTEND_PORT=3001

    # إعدادات JWT للواجهة الخلفية
    JWT_SECRET=your_very_strong_and_secret_key_for_jwt # <-- هام: قم بتغيير هذا المفتاح!
    JWT_EXPIRATION_TIME=3600s # مثال: ساعة واحدة

    # عنوان URL لواجهة برمجة التطبيقات (API) الذي ستستخدمه الواجهة الأمامية للاتصال بالواجهة الخلفية
    # هام: يجب أن يكون هذا هو العنوان الذي يمكن الوصول إليه من متصفح المستخدم
    # إذا كنت تشغل Docker محلياً، فعادةً ما يكون هذا هو localhost مع منفذ الواجهة الخلفية
    NEXT_PUBLIC_API_URL=http://localhost:3000 # أو http://<your-server-ip>:3000 إذا كان على خادم

    # إعدادات قاعدة بيانات PostgreSQL (إذا قررت استخدامها بدلاً من SQLite)
    # قم بإزالة التعليق وتعديل القيم إذا كنت تستخدم PostgreSQL
    # DATABASE_HOST=db # اسم خدمة قاعدة البيانات في docker-compose.yml (إذا أضفت خدمة قاعدة بيانات)
    # DATABASE_PORT=5432
    # DATABASE_USER=postgres
    # DATABASE_PASSWORD=your_secure_password
    # DATABASE_NAME=bidex_db
    ```

2.  **تعديل القيم:**
    *   **`JWT_SECRET`:** قم بتغيير هذا إلى مفتاح سري قوي وفريد.
    *   **`NEXT_PUBLIC_API_URL`:** تأكد من أن هذا العنوان صحيح ويمكن الوصول إليه من المتصفح الذي ستستخدمه للوصول إلى الواجهة الأمامية. إذا كان الخادم الخاص بك له عنوان IP عام، استخدمه بدلاً من `localhost`.
    *   **المنافذ:** يمكنك تغيير `BACKEND_PORT` و `FRONTEND_PORT` إذا كانت المنافذ 3000 أو 3001 مستخدمة بالفعل على جهازك المضيف.
    *   **قاعدة البيانات:** الإعداد الحالي يستخدم SQLite (سيتم حفظ الملف `bidex_db` داخل مجلد `backend`). إذا أردت استخدام PostgreSQL، ستحتاج إلى تعديل ملف `docker-compose.yml` لإضافة خدمة قاعدة بيانات PostgreSQL وتحديث متغيرات البيئة `DATABASE_*` في ملف `.env`، بالإضافة إلى تعديل `backend/src/app.module.ts`.

### تشغيل التطبيق باستخدام Docker Compose

1.  **افتح الطرفية (Terminal) أو موجه الأوامر (Command Prompt).**
2.  **انتقل إلى المجلد الجذر للحزمة** (`bidex_updated_package`).
3.  **قم ببناء وتشغيل الحاويات:**
    ```bash
    docker-compose up --build -d
    ```
    *   `--build`: يقوم ببناء الصور إذا لم تكن موجودة أو إذا تغيرت الملفات المصدرية.
    *   `-d`: يقوم بتشغيل الحاويات في الخلفية (detached mode).

4.  **الوصول إلى التطبيق:**
    *   **الواجهة الأمامية:** افتح متصفح الويب وانتقل إلى `http://localhost:3001` (أو المنفذ الذي حددته في `FRONTEND_PORT`).
    *   **الواجهة الخلفية (API):** ستكون متاحة على `http://localhost:3000` (أو المنفذ الذي حددته في `BACKEND_PORT`).

### أوامر Docker Compose المفيدة الأخرى

*   **إيقاف الحاويات:** `docker-compose down`
*   **عرض سجلات الحاويات:** `docker-compose logs -f` (أو `docker-compose logs -f backend` لعرض سجلات الواجهة الخلفية فقط)
*   **إعادة بناء الصور:** `docker-compose build`

---

## الخيار الثاني: الإعداد اليدوي (بدون Docker)

إذا كنت تفضل عدم استخدام Docker، يمكنك اتباع الخطوات اليدوية التالية. لاحظ أن هذا يتطلب تثبيت Node.js و npm مباشرة على نظامك وقد يكون أكثر عرضة لمشاكل التوافق بين البيئات.

### المتطلبات الأساسية (يدوي)

*   **Node.js:** (يوصى بإصدار LTS، مثل v20.x أو أحدث)
*   **npm:** (مدير حزم Node، يأتي عادةً مع Node.js)

### إعداد الواجهة الخلفية (يدوي)

1.  **الانتقال إلى مجلد الواجهة الخلفية:** `cd backend`
2.  **إنشاء ملف البيئة:** أنشئ ملف `.env` داخل `backend` كما هو موضح في قسم Docker، ولكن تأكد من أن إعدادات قاعدة البيانات (إذا كنت تستخدم PostgreSQL) تشير إلى خادم قاعدة البيانات الصحيح الذي يمكن الوصول إليه من جهازك.
3.  **تثبيت الاعتماديات:** `npm install`
4.  **بناء التطبيق:** `npm run build`
5.  **تشغيل التطبيق:** `node dist/main` (أو استخدم PM2: `pm2 start dist/main.js --name bidex-backend`)
    *   ستعمل الواجهة الخلفية على المنفذ المحدد في `backend/.env` (الافتراضي 3000).

### إعداد الواجهة الأمامية (يدوي)

1.  **الانتقال إلى مجلد الواجهة الأمامية:** `cd ../frontend`
2.  **إنشاء ملف البيئة:** أنشئ ملف `.env.local` داخل `frontend` بالمحتوى التالي، مع استبدال عنوان URL بعنوان الواجهة الخلفية قيد التشغيل:
    ```dotenv
    NEXT_PUBLIC_API_URL=http://localhost:3000 # أو عنوان الواجهة الخلفية الفعلي
    ```
3.  **تثبيت الاعتماديات:** `npm install`
4.  **بناء التطبيق:** `npm run build`
5.  **تشغيل التطبيق:** `npm start`
    *   ستعمل الواجهة الأمامية عادةً على منفذ متاح (مثل 3001 إذا كان 3000 مشغولاً). تحقق من مخرجات الطرفية.

## ملاحظات النشر الإضافية

*   **الأمان:** استخدم دائمًا أسرارًا قوية وفريدة لـ `JWT_SECRET` وكلمات مرور قاعدة البيانات. تأكد من تكوين HTTPS في بيئة الإنتاج.
*   **قاعدة البيانات:** لبيئة الإنتاج، يفضل استخدام خدمة قاعدة بيانات مُدارة (مثل AWS RDS، Google Cloud SQL) بدلاً من SQLite.

بالتوفيق!

